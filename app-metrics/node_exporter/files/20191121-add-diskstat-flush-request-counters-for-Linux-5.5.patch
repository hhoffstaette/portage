From 2771c075371f31d08223bd8e3df330fc783025e2 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Holger=20Hoffst=C3=A4tte?= <holger@applied-asynchrony.com>
Date: Thu, 21 Nov 2019 22:30:28 +0100
Subject: [PATCH 1/2] Add diskstat flush request counters for Linux 5.5+
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: Holger Hoffst√§tte <holger@applied-asynchrony.com>
---
 collector/diskstats_linux.go | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)

diff --git a/collector/diskstats_linux.go b/collector/diskstats_linux.go
index 1d39f2b..32bb90c 100644
--- a/collector/diskstats_linux.go b/collector/diskstats_linux.go
+++ b/collector/diskstats_linux.go b/collector/diskstats_linux.go
@@ -160,6 +160,23 @@ func NewDiskstatsCollector() (Collector, error) {
 				), valueType: prometheus.CounterValue,
 				factor: .001,
 			},
+			{
+				desc: prometheus.NewDesc(
+					prometheus.BuildFQName(namespace, diskSubsystem, "flush_requests_total"),
+					"The total number of flush requests completed successfully",
+					diskLabelNames,
+					nil,
+				), valueType: prometheus.CounterValue,
+			},
+			{
+				desc: prometheus.NewDesc(
+					prometheus.BuildFQName(namespace, diskSubsystem, "flush_requests_time_seconds_total"),
+					"This is the total number of seconds spent by all flush requests.",
+					diskLabelNames,
+					nil,
+				), valueType: prometheus.CounterValue,
+				factor: .001,
+			},
 		},
 	}, nil
 }
-- 
2.24.0

